$ModLoad imudp
$UDPServerAddress 127.0.0.1
$UDPServerRun 514
module(load="builtin:omfile")

if $programname startswith 'Keepalived_healthcheckers' then {
  if $syslogseverity == 6 then
      action(type="omfile" file="{{ keepalived_path_logs }}/status.log")
      stop
  if $syslogseverity <= 3 then
      action(type="omfile" file="{{ keepalived_path_logs }}/error.log")
      stop
  if $syslogseverity <= 5 then
      action(type="omfile" file="{{ keepalived_path_logs }}/status.log")
      stop
}

if $programname startswith 'keepalived' then {
  if $syslogseverity == 6 then
      action(type="omfile" file="{{ keepalived_path_logs }}/status.log")
      stop
  if $syslogseverity <= 3 then
      action(type="omfile" file="{{ keepalived_path_logs }}/error.log")
      stop
  if $syslogseverity <= 5 then
      action(type="omfile" file="{{ keepalived_path_logs }}/status.log")
      stop
}